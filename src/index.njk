---
layout: layouts/base.njk
title: Home
---

{# -----------------------------
   Data setup
------------------------------ #}
{% set all = collections.posts | default([]) %}
{% set hero = all[0] %}
{% set rest = all | exceptByUrl(hero.url if hero else '') %}
{% set cats = collections.categoryList | default([]) %}

{# Small card component #}
{% macro Card(post) %}
<article class="card">
  <a href="{{ post.url }}" class="thumb" aria-label="{{ post.data.title }}">
    <img src="{{ post.data.image or '/assets/fallback-thumb.jpg' }}"
         alt="{{ post.data.title | safe }}"
         loading="lazy" decoding="async" width="600" height="338">
  </a>
  <div class="meta">
    {% set catName = (post.data._categoryName or post.data._primaryCategoryName) %}
    {% set catKey  = (post.data._categoryKey  or post.data._primaryCategoryKey) %}
    {% if catName and catKey %}
      <a class="pill" href="/category/{{ catKey }}/">{{ catName }}</a>
    {% endif %}
    <h3 class="hed"><a href="{{ post.url }}">{{ post.data.title }}</a></h3>
    {% if post.date %}
      <time datetime="{{ post.date | isoDate }}">{{ post.date | displayDate('en-US') }}</time>
    {% endif %}
  </div>
</article>
{% endmacro %}

{# -----------------------------
   Page-local styles
------------------------------ #}
<style>
  :root{ --maxw:1120px; --gap:1rem; --ink:#111; --muted:#666; --rule:#e6e6e6; --measure:68ch; }
  *{ box-sizing:border-box; } html{ text-size-adjust:100%; }
  body{ color:var(--ink); font-family:"EB Garamond",Garamond,Georgia,serif; }

  /* A11y: keep semantic H1 without visual duplication */
  .sr-only{
    position:absolute!important; width:1px; height:1px; padding:0; margin:-1px;
    overflow:hidden; clip:rect(0,0,1px,1px); white-space:nowrap; border:0;
  }

  /* Category row under the (hidden) title */
  nav[aria-label="Primary"]{ margin:.25rem 0 .75rem; }
  nav[aria-label="Primary"] .navlinks{
    display:flex; flex-wrap:wrap; gap:.6rem 1rem;
    letter-spacing:.04em; font-variant-caps:small-caps;
  }

  /* Hero block */
  .hero{ display:grid; gap:var(--gap); grid-template-columns:1fr; padding-block:1.25rem; border-bottom:1px solid var(--rule); }
  .hero .media img{ width:100%; height:auto; aspect-ratio:16/9; object-fit:cover; background:#f2f2f2; }
  .hero .hed{
    font-family:"Newsreader","EB Garamond",Georgia,serif; font-weight:700; letter-spacing:.006em; line-height:1.12;
    font-size:clamp(1.75rem,3.5vw,2.4rem); margin:.5rem 0; text-wrap:balance;
  }
  .dek{ color:#333; font-size:clamp(1rem,1.2vw,1.15rem); max-width:var(--measure); margin-top:.5rem; }
  .byline{ color:var(--muted); font-size:.95rem; }

  /* Sections */
  .section{ padding-block:1rem; border-bottom:1px solid var(--rule); }
  .section-head{ display:flex; justify-content:space-between; align-items:baseline; margin-bottom:.5rem; gap:.5rem; }
  .section-head h2{
    font-family:"Newsreader","EB Garamond",Georgia,serif; font-weight:600; letter-spacing:.005em;
    font-size:clamp(1.4rem,2.2vw,2rem); line-height:1.15; margin:0;
  }
  .section-head .more{ font-variant:small-caps; letter-spacing:.04em; color:#444; text-decoration:none; }
  .section-head .more:hover{ text-decoration:underline; }

  /* Card grid */
  .grid{ display:grid; gap:var(--gap); grid-template-columns:repeat(auto-fill,minmax(280px,1fr)); }
  .card{ display:flex; flex-direction:column; gap:.5rem; }
  .card .thumb img{ width:100%; height:auto; aspect-ratio:16/9; object-fit:cover; background:#f2f2f2; }
  .pill{ font-size:.72rem; text-transform:uppercase; letter-spacing:.04em; color:#555; }
  .meta time{ color:#666; font-size:.95rem; }

  @media (min-width:900px){
    .hero{ grid-template-columns:1.15fr .85fr; }
  }
</style>

{# -----------------------------
   Page content (wrapped to align with masthead width)
------------------------------ #}

<div class="wrap">
  <h1 class="sr-only">The Argosy</h1>

  <nav aria-label="Primary">
    <div class="navlinks">
      {% for c in cats %}
        <a href="/category/{{ c.key }}/">{{ c.name }}</a>
      {% endfor %}
    </div>
  </nav>

  <section class="hero" aria-label="Lead story">
    {% if hero %}
      <div class="media">
        <a href="{{ hero.url }}">
          <img src="{{ hero.data.image or '/assets/fallback-hero.jpg' }}"
               alt="{{ hero.data.title | safe }}"
               loading="eager" decoding="async" width="1200" height="675">
        </a>
      </div>
      <article class="meta">
        {% if hero.data._primaryCategoryName and hero.data._primaryCategoryKey %}
          <a class="pill" href="/category/{{ hero.data._primaryCategoryKey }}/">{{ hero.data._primaryCategoryName }}</a>
        {% endif %}

        <h2 class="hed"><a href="{{ hero.url }}">{{ hero.data.title }}</a></h2>

        <p class="dek">{{ hero.data.description or hero.templateContent | striptags | truncate(180) }}</p>

        {# Remove duplicate leading "By " if author already includes it #}
        {% set rawAuthor = hero.data.author or '' %}
        {% set authorClean = rawAuthor | replace('By ', '') %}
        <p class="byline">
          {% if authorClean %}By {{ authorClean }} Â· {% endif %}
          {% if hero.date %}<time datetime="{{ hero.date | isoDate }}">{{ hero.date | displayDate('en-US') }}</time>{% endif %}
        </p>
      </article>
    {% else %}
      <article><h2 class="hed">No articles yet</h2></article>
    {% endif %}
  </section>

  <section class="section" aria-label="Top Stories">
    <div class="section-head"><h2>Top Stories</h2></div>
    <div class="grid">
      {% for post in rest | take(6) %}
        {{ Card(post) | safe }}
      {% else %}
        <p class="muted">More stories coming soon.</p>
      {% endfor %}
    </div>
  </section>

  {% for c in cats %}
    <section class="section category-block" id="{{ c.key }}">
      <div class="section-head">
        <h2>{{ c.name }}</h2>
        <a class="more" href="/category/{{ c.key }}/">More</a>
      </div>
      <div class="grid">
        {% for post in c.items | take(6) %}
          {{ Card(post) | safe }}
        {% else %}
          <p class="muted">No articles yet in this section.</p>
        {% endfor %}
      </div>
    </section>
  {% endfor %}
</div>
